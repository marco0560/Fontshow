#!/bin/sh

echo "üîç Running pre-commit checks before push..."
pre-commit run --all-files
echo "‚úÖ pre-push checks passed"

echo "üì¶ Preview changelog (semantic-release dry-run)..."

if command -v npx >/dev/null 2>&1; then
  if npm list --depth=0 @semantic-release/changelog >/dev/null 2>&1; then
    npx semantic-release --dry-run || {
      echo "‚ùå semantic-release preview failed"
      exit 1
    }
  else
    echo "‚ö†Ô∏è  semantic-release plugins not installed locally, skipping preview (CI will enforce)"
  fi
else
  echo "‚ö†Ô∏è  npx not found, skipping semantic-release preview (CI will enforce)"
fi
