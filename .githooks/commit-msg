#!/usr/bin/env python3
import re
import sys

msg_file = sys.argv[1]

with open(msg_file, encoding="utf-8") as f:
    first_line = f.readline().strip()

pattern = re.compile(
    r"^(feat|fix|docs|refactor|test|chore)" r"(\([a-z0-9._-]+\))?" r"!?: .{1,72}$"
)

if not pattern.match(first_line):
    print("ERROR: commit message non conforme.")
    print("Formato richiesto:")
    print("  type(scope): summary")
    print("Esempio:")
    print("  feat(core): add new option")
    sys.exit(1)
